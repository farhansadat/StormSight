<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StormSight - Advanced Weather Application</title>
    <meta name="description" content="Professional weather application with interactive radar, real-time forecasts, and detailed weather analytics">
    <meta name="keywords" content="weather, forecast, radar, storm tracking, meteorology">
    <meta name="author" content="Said Alimullah Sadat">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="StormSight - Advanced Weather Application">
    <meta property="og:description" content="Professional weather application with interactive radar and real-time forecasts">
    <meta property="og:type" content="website">
    <meta property="og:image" content="/assets/stormsight-preview.png">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="StormSight - Advanced Weather Application">
    <meta name="twitter:description" content="Professional weather application with interactive radar and real-time forecasts">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
    <link rel="alternate icon" href="/assets/favicon.ico">
    
    <!-- Preconnect to external domains -->
    <link rel="preconnect" href="https://api.openweathermap.org">
    <link rel="preconnect" href="https://ipapi.co">
    
    <style>
        /* CSS Variables */
        :root {
            --primary: #3b82f6;
            --primary-dark: #1d4ed8;
            --secondary: #64748b;
            --accent: #06b6d4;
            --background: linear-gradient(135deg, #1e293b 0%, #334155 50%, #475569 100%);
            --card-bg: rgba(255, 255, 255, 0.08);
            --card-border: rgba(255, 255, 255, 0.12);
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --glass-bg: rgba(255, 255, 255, 0.06);
            --glass-border: rgba(255, 255, 255, 0.15);
            --shadow-light: 0 4px 16px rgba(0, 0, 0, 0.1);
            --shadow-strong: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        /* Global Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--background);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.6;
        }

        /* Layout Styles */
        .app-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* Header Styles */
        .header {
            padding: 20px 40px;
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .app-branding {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .app-logo {
            font-size: 2rem;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
        }

        .app-title {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #60a5fa, #3b82f6, #1d4ed8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .search-container {
            position: relative;
        }

        .search-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            padding: 12px 20px;
            color: var(--text-primary);
            font-size: 0.9rem;
            width: 300px;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
        }

        .search-input::placeholder {
            color: var(--text-secondary);
        }

        .temp-toggle {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 8px 16px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
        }

        .temp-toggle:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        /* Main Content Layout */
        .main-content {
            flex: 1;
            padding: 40px;
            position: relative;
            z-index: 2000;
            max-width: 1600px;
            margin: 0 auto;
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 50px;
        }

        .content-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 40px;
            align-items: start;
        }

        .main-column {
            display: flex;
            flex-direction: column;
            gap: 50px;
        }

        .radar-section {
            margin-top: 30px;
        }

        .stats-sidebar {
            display: flex;
            flex-direction: column;
            gap: 30px;
            min-height: fit-content;
        }

        /* Glass Card Styles */
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(30px);
            border: 1px solid var(--glass-border);
            border-radius: 32px;
            padding: 40px;
            box-shadow: var(--shadow-strong);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .glass-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        }

        .glass-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.3);
        }

        /* Hero Weather Card */
        .hero-weather-card {
            background: var(--glass-bg);
            backdrop-filter: blur(30px);
            border: 1px solid var(--glass-border);
            border-radius: 32px;
            padding: 40px;
            box-shadow: var(--shadow-strong);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .hero-weather-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        }

        .hero-weather-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.3);
        }

        .current-weather-main {
            display: flex;
            align-items: center;
            gap: 30px;
            margin-bottom: 40px;
        }

        .weather-icon-container {
            flex-shrink: 0;
        }

        .weather-icon {
            font-size: 5rem;
            line-height: 1;
            filter: drop-shadow(0 8px 16px rgba(0, 0, 0, 0.3));
        }

        .weather-info {
            flex: 1;
        }

        .current-temp {
            font-size: 4rem;
            font-weight: 700;
            line-height: 1;
            background: linear-gradient(135deg, #60a5fa, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .current-condition {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 15px;
            font-weight: 500;
        }

        .current-location {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        /* Weather Stats Grid */
        .weather-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-2px);
        }

        .stat-icon {
            font-size: 1.5rem;
            margin-bottom: 8px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Sidebar Cards */
        .sidebar-card {
            background: var(--glass-bg);
            backdrop-filter: blur(30px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 30px;
            box-shadow: var(--shadow-light);
            transition: all 0.3s ease;
        }

        .sidebar-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-strong);
        }

        .sidebar-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--text-primary);
        }

        /* Hourly Forecast */
        .hourly-forecast {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-height: 300px;
            overflow-y: auto;
        }

        .hourly-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .hourly-item:last-child {
            border-bottom: none;
        }

        .hourly-time {
            font-size: 0.9rem;
            color: var(--text-secondary);
            min-width: 60px;
        }

        .hourly-icon {
            font-size: 1.2rem;
            margin: 0 10px;
        }

        .hourly-temp {
            font-weight: 600;
            min-width: 50px;
            text-align: right;
        }

        /* Air Quality */
        .air-quality {
            text-align: center;
        }

        .aqi-value {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #10b981, #059669);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .aqi-label {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #10b981;
        }

        .aqi-description {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        /* Sun & Moon */
        .sun-moon-info {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .sun-moon-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
        }

        .sun-moon-item .label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .sun-moon-item .value {
            font-weight: 600;
            color: var(--text-primary);
        }

        /* 7-Day Forecast */
        .forecast-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 30px;
            color: var(--text-primary);
            background: linear-gradient(135deg, #60a5fa, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .forecast-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 20px;
        }

        .forecast-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 24px 16px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .forecast-card:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .forecast-day {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .forecast-icon {
            font-size: 2.5rem;
            margin: 15px 0;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
        }

        .forecast-temps {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 15px 0;
        }

        .forecast-high {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .forecast-low {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        .forecast-desc {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 8px;
            line-height: 1.3;
        }

        /* Weather Radar Styles */
        .radar-card {
            background: var(--glass-bg);
            backdrop-filter: blur(30px);
            border: 1px solid var(--glass-border);
            border-radius: 32px;
            padding: 40px;
            box-shadow: var(--shadow-strong);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .radar-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        }

        .radar-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.3);
        }

        .radar-container {
            width: 100%;
            height: 500px;
            border-radius: 20px;
            background: #f5f5f5;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .world-map {
            position: absolute;
            top: 0;
            left: 0;
            width: 200%;
            height: 200%;
            background: 
                radial-gradient(circle at 30% 40%, #4a8bc2 0%, #2980b9 30%, #1f4e79 70%),
                url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 800'%3E%3Cpath d='M280 180 Q290 170, 310 175 L320 185 Q330 190, 325 200 L315 210 Q305 215, 295 210 L285 200 Q275 190, 280 180 Z' fill='%23e8dcc6'/%3E%3Cpath d='M250 190 Q260 185, 270 195 L275 205 Q270 215, 260 210 L250 205 Q245 195, 250 190 Z' fill='%23e8dcc6'/%3E%3Cpath d='M300 220 Q340 210, 380 230 L390 250 Q395 280, 380 310 L360 330 Q330 340, 300 330 L285 310 Q280 280, 290 250 L295 230 Q297 220, 300 220 Z' fill='%23e8dcc6'/%3E%3Cpath d='M280 340 Q320 330, 360 350 L380 370 Q385 400, 370 430 L350 450 Q320 460, 290 450 L270 430 Q265 400, 275 370 L280 350 Q280 340, 280 340 Z' fill='%23e8dcc6'/%3E%3Cpath d='M400 200 Q440 190, 480 210 L490 230 Q495 260, 480 290 L460 310 Q430 320, 400 310 L385 290 Q380 260, 390 230 L395 210 Q397 200, 400 200 Z' fill='%23e8dcc6'/%3E%3Cpath d='M420 320 Q440 310, 460 330 L470 350 Q475 400, 465 450 L455 480 Q445 490, 435 485 L425 475 Q415 450, 420 400 L425 350 Q422 330, 420 320 Z' fill='%23e8dcc6'/%3E%3Cpath d='M500 180 Q540 170, 580 190 L590 210 Q595 240, 580 270 L560 290 Q530 300, 500 290 L485 270 Q480 240, 490 210 L495 190 Q497 180, 500 180 Z' fill='%23e8dcc6'/%3E%3Cpath d='M480 80 Q520 70, 560 90 L580 110 Q590 150, 575 180 L555 200 Q525 210, 495 200 L475 180 Q465 150, 475 110 L480 90 Q480 80, 480 80 Z' fill='%23e8dcc6'/%3E%3Cpath d='M380 180 Q400 175, 420 185 L425 195 Q430 205, 420 215 L400 225 Q380 230, 370 220 L365 205 Q370 195, 375 185 Q378 180, 380 180 Z' fill='%23e8dcc6'/%3E%3Cpath d='M430 280 Q460 275, 490 285 L500 295 Q505 305, 495 315 L465 325 Q435 330, 425 320 L420 305 Q425 295, 430 285 Q430 280, 430 280 Z' fill='%23d4c4a8'/%3E%3C/svg%3E") center/cover;
            transition: transform 0.3s ease;
            transform-origin: center center;
        }

        .map-container {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
            cursor: grab;
        }

        .map-container:active {
            cursor: grabbing;
        }

        .map-container.zoomed .world-map {
            transform: scale(2.5);
        }

        .map-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px),
                linear-gradient(180deg, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 50px 50px;
        }

        .city-marker {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #e74c3c;
            border: 2px solid #fff;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 15;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }

        .city-marker:hover {
            transform: translate(-50%, -50%) scale(1.3);
            background: #c0392b;
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }

        .city-label {
            position: absolute;
            font-size: 11px;
            font-weight: 600;
            color: #2c3e50;
            background: rgba(255, 255, 255, 0.95);
            padding: 4px 8px;
            border-radius: 6px;
            transform: translateX(-50%);
            white-space: nowrap;
            z-index: 10;
            border: 1px solid rgba(0,0,0,0.1);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }

        .city-marker:hover + .city-label {
            background: #3498db;
            color: white;
            transform: translateX(-50%) translateY(-5px);
        }

        .zoom-controls {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            z-index: 20;
        }

        .zoom-btn {
            width: 40px;
            height: 40px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            color: white;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .zoom-btn:hover {
            background: rgba(52, 152, 219, 0.8);
            transform: scale(1.05);
        }

        .map-info {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 15px;
            font-size: 0.85rem;
            color: white;
            z-index: 15;
            max-width: 250px;
        }

        .weather-layers {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .cloud-layer {
            position: absolute;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.7) 0%, rgba(255, 255, 255, 0.3) 50%, transparent 70%);
            border-radius: 50%;
            animation: cloudDrift 20s linear infinite;
            border: 1px solid rgba(255, 255, 255, 0.4);
        }

        .temperature-zone {
            position: absolute;
            border-radius: 50%;
            animation: tempPulse 8s ease-in-out infinite;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .lightning-strike {
            position: absolute;
            width: 3px;
            height: 25px;
            background: linear-gradient(180deg, #FFD700, #FF4500);
            opacity: 0;
            animation: lightningStrike 4s ease-in-out infinite;
            border-radius: 2px;
            box-shadow: 0 0 10px #FFD700;
        }

        .air-quality-zone {
            position: absolute;
            border-radius: 50%;
            border: 2px solid rgba(255, 100, 100, 0.6);
            animation: aqiPulse 6s ease-in-out infinite;
            background: rgba(255, 100, 100, 0.1);
        }

        @keyframes cloudDrift {
            0% { transform: translateX(-20px); }
            100% { transform: translateX(20px); }
        }

        @keyframes tempPulse {
            0%, 100% { opacity: 0.5; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.1); }
        }

        @keyframes lightningStrike {
            0%, 95%, 100% { opacity: 0; }
            2%, 8% { opacity: 1; }
            5% { opacity: 0.7; }
        }

        @keyframes aqiPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.7; }
        }

        .radar-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 10;
        }

        .layer-toggle {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 8px 12px;
            color: var(--text-secondary);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .layer-toggle.active {
            background: rgba(0, 255, 0, 0.2);
            border-color: rgba(0, 255, 0, 0.5);
            color: #00ff00;
        }

        .radar-legend {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 15px;
            font-size: 0.85rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        .legend-item:last-child {
            margin-bottom: 0;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        /* Loading and Error States */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            backdrop-filter: blur(10px);
        }

        .loading-content {
            text-align: center;
            color: var(--text-primary);
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 3px solid rgba(59, 130, 246, 0.3);
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .loading-subtext {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .error-container {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 20px;
            color: #fca5a5;
            text-align: center;
        }

        .error-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: #f87171;
        }

        .error-message {
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* Footer */
        .footer {
            background: rgba(0, 0, 0, 0.3);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 30px 40px;
            text-align: center;
            color: var(--text-secondary);
        }

        .footer-content {
            max-width: 1600px;
            margin: 0 auto;
        }

        .footer-branding {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #60a5fa, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .footer-credits {
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            font-size: 0.85rem;
        }

        .footer-links a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: var(--primary);
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .content-grid {
                grid-template-columns: 1fr;
                gap: 30px;
            }
            
            .header-content {
                flex-direction: column;
                gap: 20px;
            }
            
            .search-input {
                width: 250px;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 20px;
                gap: 30px;
            }
            
            .header {
                padding: 15px 20px;
            }
            
            .app-title {
                font-size: 1.5rem;
            }
            
            .search-input {
                width: 200px;
            }
            
            .current-temp {
                font-size: 3rem;
            }
            
            .weather-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .forecast-container {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
                gap: 15px;
            }
            
            .radar-container {
                height: 400px;
            }
        }

        @media (max-width: 480px) {
            .main-content {
                padding: 15px;
            }
            
            .hero-weather-card,
            .glass-card,
            .radar-card {
                padding: 25px;
                border-radius: 20px;
            }
            
            .current-weather-main {
                flex-direction: column;
                text-align: center;
                gap: 20px;
            }
            
            .weather-icon {
                font-size: 4rem;
            }
            
            .current-temp {
                font-size: 2.5rem;
            }
            
            .weather-stats {
                grid-template-columns: 1fr;
            }
            
            .forecast-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Floating Particles Animation */
        .floating-particle {
            position: fixed;
            pointer-events: none;
            opacity: 0.6;
            z-index: 1;
        }

        .particle-snow {
            color: #e0f2fe;
            animation: float-down 8s linear infinite;
        }

        .particle-rain {
            color: #4fc3f7;
            animation: float-down 3s linear infinite;
        }

        @keyframes float-down {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.6;
            }
            90% {
                opacity: 0.6;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* Hidden state for loading */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Loading Screen -->
        <div class="loading-overlay" id="loading-overlay">
            <div class="loading-content">
                <div class="spinner"></div>
                <div class="loading-text" id="loading-text">Initializing StormSight...</div>
                <div class="loading-subtext" id="loading-subtext">Preparing your weather experience</div>
            </div>
        </div>

        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="app-branding">
                    <div class="app-logo">üå©Ô∏è</div>
                    <h1 class="app-title">StormSight</h1>
                </div>
                
                <div class="header-controls">
                    <div class="search-container">
                        <input 
                            type="text" 
                            class="search-input" 
                            placeholder="Search for cities..."
                            id="city-search"
                        >
                    </div>
                    <button class="temp-toggle" id="temp-toggle">¬∞C / ¬∞F</button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content" id="main-content">
            <!-- Top Section with Weather and Sidebar -->
            <div class="content-grid">
                <div class="main-column">
                    <!-- Hero Weather Section -->
                    <section class="hero-section">
                        <div class="hero-weather-card">
                            <div class="current-weather-main">
                                <div class="weather-icon-container">
                                    <div class="weather-icon" id="main-weather-icon">‚òÄÔ∏è</div>
                                </div>
                                <div class="weather-info">
                                    <div class="current-temp" id="current-temp">21¬∞</div>
                                    <div class="current-condition" id="current-condition">Clear Sky</div>
                                    <div class="current-location" id="current-location">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                                            <circle cx="12" cy="10" r="3"></circle>
                                        </svg>
                                        London, GB
                                    </div>
                                </div>
                            </div>
                            
                            <div class="weather-stats">
                                <div class="stat-card">
                                    <div class="stat-icon">üå°Ô∏è</div>
                                    <div class="stat-label">Feels like</div>
                                    <div class="stat-value" id="feels-like">24¬∞</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">üíß</div>
                                    <div class="stat-label">Humidity</div>
                                    <div class="stat-value" id="humidity">65%</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">üí®</div>
                                    <div class="stat-label">Wind Speed</div>
                                    <div class="stat-value" id="wind-speed">12 km/h</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">üåÄ</div>
                                    <div class="stat-label">Pressure</div>
                                    <div class="stat-value" id="pressure">1013 hPa</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">üëÅÔ∏è</div>
                                    <div class="stat-label">Visibility</div>
                                    <div class="stat-value" id="visibility">10 km</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">‚òÄÔ∏è</div>
                                    <div class="stat-label">UV Index</div>
                                    <div class="stat-value" id="uv-index">5</div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- 7-Day Forecast -->
                    <section class="forecast-section">
                        <h2 class="forecast-title">7-Day Forecast</h2>
                        <div class="forecast-container" id="forecast-container">
                            <!-- Forecast cards will be populated by JavaScript -->
                        </div>
                    </section>
                </div>

                <!-- Stats Sidebar -->
                <aside class="stats-sidebar">
                    <!-- Hourly Forecast -->
                    <div class="sidebar-card">
                        <h3 class="sidebar-title">Today's Hourly</h3>
                        <div class="hourly-forecast" id="hourly-forecast">
                            <!-- Hourly items will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Air Quality -->
                    <div class="sidebar-card">
                        <h3 class="sidebar-title">Air Quality</h3>
                        <div class="air-quality">
                            <div class="aqi-value" id="aqi-value">42</div>
                            <div class="aqi-label" id="aqi-label">Good</div>
                            <p class="aqi-description">Air quality is good. Perfect for outdoor activities.</p>
                        </div>
                    </div>

                    <!-- Sun & Moon -->
                    <div class="sidebar-card">
                        <h3 class="sidebar-title">Sun & Moon</h3>
                        <div class="sun-moon-info">
                            <div class="sun-moon-item">
                                <span class="label">üåÖ Sunrise</span>
                                <span class="value" id="sunrise">6:42 AM</span>
                            </div>
                            <div class="sun-moon-item">
                                <span class="label">üåá Sunset</span>
                                <span class="value" id="sunset">7:28 PM</span>
                            </div>
                            <div class="sun-moon-item">
                                <span class="label">üåô Moon Phase</span>
                                <span class="value" id="moon-phase">Waxing Crescent</span>
                            </div>
                        </div>
                    </div>
                </aside>
            </div>

            <!-- Weather Radar Map - Full Width -->
            <section class="radar-section">
                <div class="radar-card">
                    <h2 class="forecast-title">Advanced Weather Radar</h2>
                    <div class="radar-container">
                        <div class="map-container" id="map-container">
                            <div class="world-map" id="world-map"></div>
                            <div class="map-overlay"></div>
                            <div class="mountains" id="mountains">
                                <!-- Mountain ranges will be populated by JavaScript -->
                            </div>
                            <div class="rivers" id="rivers">
                                <!-- Rivers will be populated by JavaScript -->
                            </div>
                            <div id="city-markers">
                                <!-- City markers will be populated by JavaScript -->
                            </div>
                            <div class="weather-layers" id="weather-layers">
                                <!-- Weather layers will be populated by JavaScript -->
                            </div>
                        </div>
                        
                        <!-- Map Info Panel -->
                        <div class="map-info" id="map-info">
                            <div><strong>European Weather Map</strong></div>
                            <div>Scale: 1:2,500,000</div>
                            <div>Click cities to explore</div>
                            <div>Use zoom controls to navigate</div>
                        </div>
                        
                        <!-- Zoom Controls -->
                        <div class="zoom-controls">
                            <button class="zoom-btn" id="zoom-in">+</button>
                            <button class="zoom-btn" id="zoom-out">‚àí</button>
                            <button class="zoom-btn" id="reset-view">‚åÇ</button>
                        </div>
                        
                        <!-- Radar Controls -->
                        <div class="radar-controls">
                            <button class="layer-toggle active" data-layer="clouds">Clouds</button>
                            <button class="layer-toggle active" data-layer="temperature">Temperature</button>
                            <button class="layer-toggle active" data-layer="lightning">Lightning</button>
                            <button class="layer-toggle active" data-layer="air-quality">Air Quality</button>
                        </div>
                        
                        <!-- Radar Legend -->
                        <div class="radar-legend">
                            <div class="legend-item">
                                <div class="legend-color" style="background: rgba(255, 255, 255, 0.5);"></div>
                                <span>Clouds</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: linear-gradient(45deg, #0066ff, #ff6600);"></div>
                                <span>Temperature</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #FFD700;"></div>
                                <span>Lightning</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: rgba(255, 100, 100, 0.6);"></div>
                                <span>Air Quality</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <div class="footer-branding">StormSight Weather Application</div>
                <div class="footer-credits">
                    Created with passion by <strong>Said Alimullah Sadat</strong>
                </div>
                <div class="footer-links">
                    <span>Professional Weather Analytics</span>
                    <span>‚Ä¢</span>
                    <span>Real-time Data</span>
                    <span>‚Ä¢</span>
                    <span>Interactive Radar</span>
                </div>
            </div>
        </footer>
    </div>

    <script>
        class StormSightApp {
            constructor() {
                this.isMetric = true;
                this.currentWeatherData = null;
                this.forecastData = null;
                this.currentZoom = 1;
                this.mapPosition = { x: 0, y: 0 };
                this.isDragging = false;
                this.dragStart = { x: 0, y: 0 };
            }

            async init() {
                console.log('Initializing StormSight...');
                this.createFloatingParticles();
                this.setupEventListeners();
                this.addInteractiveEffects();
                this.createGeographicFeatures();
                this.createCityMarkers();
                this.createWeatherLayers();
                this.setupMapInteractivity();
                await this.getCurrentLocationAndLoadWeather();
            }

            // API Functions using Netlify Functions
            async makeAPIRequest(endpoint, params = {}) {
                const searchParams = new URLSearchParams(params);
                const url = `/.netlify/functions/${endpoint}?${searchParams}`;
                
                try {
                    const response = await fetch(url);
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return await response.json();
                } catch (error) {
                    console.error(`API request failed for ${endpoint}:`, error);
                    throw error;
                }
            }

            async getCurrentLocationAndLoadWeather() {
                this.showLoading('Detecting your location...');
                
                // Try to get user's location first
                if (navigator.geolocation) {
                    try {
                        const position = await new Promise((resolve, reject) => {
                            navigator.geolocation.getCurrentPosition(resolve, reject, {
                                timeout: 10000,
                                enableHighAccuracy: true,
                                maximumAge: 300000
                            });
                        });
                        
                        await this.loadWeather(position.coords.latitude, position.coords.longitude);
                        return;
                    } catch (error) {
                        console.log('Geolocation failed, using IP-based location');
                    }
                }
                
                // Fallback to IP-based location
                try {
                    const response = await fetch('https://ipapi.co/json/');
                    const locationData = await response.json();
                    
                    if (locationData.latitude && locationData.longitude) {
                        await this.loadWeather(locationData.latitude, locationData.longitude);
                        return;
                    }
                } catch (error) {
                    console.log('IP location failed, using default location');
                }
                
                // Final fallback to London
                await this.loadWeather(51.5074, -0.1278);
            }

            async loadWeather(lat = 51.5074, lon = -0.1278) {
                try {
                    this.showLoading('Loading weather data...');
                    
                    const [currentWeather, forecast] = await Promise.all([
                        this.makeAPIRequest('weather-current', { lat, lon }),
                        this.makeAPIRequest('weather-forecast', { lat, lon })
                    ]);

                    this.currentWeatherData = currentWeather;
                    this.forecastData = forecast;

                    this.updateCurrentWeather(currentWeather);
                    this.updateForecast(forecast);
                    this.updateHourlyForecast(forecast);
                    this.hideLoading();

                } catch (error) {
                    console.error('Error loading weather:', error);
                    this.showError('Weather Error', 'Unable to load weather data. Please try again.');
                }
            }

            async loadWeatherForCity(cityName) {
                try {
                    this.showLoading(`Loading weather for ${cityName}...`);
                    
                    const cityData = await this.makeAPIRequest('weather-search', { q: cityName });
                    const { lat, lon } = cityData.coord;
                    
                    await this.loadWeather(lat, lon);
                    
                } catch (error) {
                    console.error('Error loading weather for city:', error);
                    this.showError('Weather Error', `Could not load weather data for ${cityName}`);
                }
            }

            updateCurrentWeather(data) {
                const tempUnit = this.isMetric ? '¬∞C' : '¬∞F';
                const windUnit = this.isMetric ? 'km/h' : 'mph';
                
                const temp = this.isMetric ? data.main.temp : (data.main.temp * 9/5) + 32;
                const feelsLike = this.isMetric ? data.main.feels_like : (data.main.feels_like * 9/5) + 32;
                const windSpeed = this.isMetric ? (data.wind.speed * 3.6) : (data.wind.speed * 2.237);

                document.getElementById('current-temp').textContent = `${Math.round(temp)}${tempUnit}`;
                document.getElementById('current-condition').textContent = this.capitalizeWords(data.weather[0].description);
                document.getElementById('current-location').innerHTML = `
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                        <circle cx="12" cy="10" r="3"></circle>
                    </svg>
                    ${data.name}, ${data.sys.country}
                `;

                document.getElementById('feels-like').textContent = `${Math.round(feelsLike)}${tempUnit}`;
                document.getElementById('humidity').textContent = `${data.main.humidity}%`;
                document.getElementById('wind-speed').textContent = `${Math.round(windSpeed)} ${windUnit}`;
                document.getElementById('pressure').textContent = `${data.main.pressure} hPa`;
                document.getElementById('visibility').textContent = `${(data.visibility / 1000).toFixed(1)} km`;
                document.getElementById('uv-index').textContent = Math.floor(Math.random() * 8) + 1;

                document.getElementById('main-weather-icon').textContent = this.getWeatherIcon(data.weather[0].main, data.weather[0].icon);

                const sunrise = new Date(data.sys.sunrise * 1000).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                const sunset = new Date(data.sys.sunset * 1000).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                
                document.getElementById('sunrise').textContent = sunrise;
                document.getElementById('sunset').textContent = sunset;
            }

            updateForecast(data) {
                const container = document.getElementById('forecast-container');
                container.innerHTML = '';

                const dailyForecasts = this.processDailyForecasts(data.list);
                
                dailyForecasts.slice(0, 7).forEach((forecast, index) => {
                    const card = this.createForecastCard(forecast, index);
                    container.appendChild(card);
                });
            }

            updateHourlyForecast(data) {
                const container = document.getElementById('hourly-forecast');
                container.innerHTML = '';

                data.list.slice(0, 8).forEach(item => {
                    const time = new Date(item.dt * 1000).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                    const temp = this.isMetric ? item.main.temp : (item.main.temp * 9/5) + 32;
                    const tempUnit = this.isMetric ? '¬∞C' : '¬∞F';

                    const hourlyItem = document.createElement('div');
                    hourlyItem.className = 'hourly-item';
                    hourlyItem.innerHTML = `
                        <div class="hourly-time">${time}</div>
                        <div class="hourly-icon">${this.getWeatherIcon(item.weather[0].main, item.weather[0].icon)}</div>
                        <div class="hourly-temp">${Math.round(temp)}${tempUnit}</div>
                    `;
                    container.appendChild(hourlyItem);
                });
            }

            processDailyForecasts(list) {
                const dailyData = {};
                
                list.forEach(item => {
                    const date = new Date(item.dt * 1000).toDateString();
                    if (!dailyData[date]) {
                        dailyData[date] = {
                            date: new Date(item.dt * 1000),
                            temps: [],
                            weather: item.weather[0],
                            humidity: item.main.humidity,
                            wind: item.wind.speed
                        };
                    }
                    dailyData[date].temps.push(item.main.temp);
                });

                return Object.values(dailyData).map(day => ({
                    ...day,
                    tempMax: Math.max(...day.temps),
                    tempMin: Math.min(...day.temps)
                }));
            }

            createForecastCard(forecast, index) {
                const tempUnit = this.isMetric ? '¬∞C' : '¬∞F';
                const maxTemp = this.isMetric ? forecast.tempMax : (forecast.tempMax * 9/5) + 32;
                const minTemp = this.isMetric ? forecast.tempMin : (forecast.tempMin * 9/5) + 32;

                const card = document.createElement('div');
                card.className = 'forecast-card';
                
                const dayName = index === 0 ? 'Today' : forecast.date.toLocaleDateString('en-US', { weekday: 'short' });
                
                card.innerHTML = `
                    <div class="forecast-day">${dayName}</div>
                    <div class="forecast-icon">${this.getWeatherIcon(forecast.weather.main, forecast.weather.icon)}</div>
                    <div class="forecast-temps">
                        <span class="forecast-high">${Math.round(maxTemp)}${tempUnit}</span>
                        <span class="forecast-low">${Math.round(minTemp)}${tempUnit}</span>
                    </div>
                    <div class="forecast-desc">${this.capitalizeWords(forecast.weather.description)}</div>
                `;

                return card;
            }

            getWeatherIcon(weatherMain, iconCode) {
                const iconMap = {
                    'Clear': '‚òÄÔ∏è',
                    'Clouds': '‚òÅÔ∏è',
                    'Rain': 'üåßÔ∏è',
                    'Drizzle': 'üå¶Ô∏è',
                    'Thunderstorm': '‚õàÔ∏è',
                    'Snow': 'üå®Ô∏è',
                    'Mist': 'üå´Ô∏è',
                    'Fog': 'üå´Ô∏è',
                    'Haze': 'üå´Ô∏è'
                };

                return iconMap[weatherMain] || 'üå§Ô∏è';
            }

            capitalizeWords(str) {
                return str.replace(/\w\S*/g, txt => 
                    txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase()
                );
            }

            // City exploration and map functionality
            createCityMarkers() {
                const citiesContainer = document.getElementById('city-markers');
                const cities = [
                    { name: 'London', x: 24, y: 30, country: 'United Kingdom', temp: '15¬∞C', condition: 'Cloudy' },
                    { name: 'Paris', x: 26, y: 35, country: 'France', temp: '18¬∞C', condition: 'Partly Cloudy' },
                    { name: 'Berlin', x: 34, y: 28, country: 'Germany', temp: '12¬∞C', condition: 'Overcast' },
                    { name: 'Madrid', x: 20, y: 50, country: 'Spain', temp: '22¬∞C', condition: 'Sunny' },
                    { name: 'Rome', x: 32, y: 52, country: 'Italy', temp: '20¬∞C', condition: 'Clear' },
                    { name: 'Amsterdam', x: 28, y: 28, country: 'Netherlands', temp: '14¬∞C', condition: 'Rainy' },
                    { name: 'Brussels', x: 26, y: 32, country: 'Belgium', temp: '16¬∞C', condition: 'Cloudy' },
                    { name: 'Vienna', x: 36, y: 38, country: 'Austria', temp: '17¬∞C', condition: 'Clear' },
                    { name: 'Prague', x: 34, y: 35, country: 'Czech Republic', temp: '13¬∞C', condition: 'Overcast' },
                    { name: 'Warsaw', x: 42, y: 28, country: 'Poland', temp: '11¬∞C', condition: 'Cloudy' },
                    { name: 'Stockholm', x: 38, y: 18, country: 'Sweden', temp: '8¬∞C', condition: 'Snow' },
                    { name: 'Oslo', x: 32, y: 15, country: 'Norway', temp: '6¬∞C', condition: 'Snow' },
                    { name: 'Copenhagen', x: 32, y: 22, country: 'Denmark', temp: '10¬∞C', condition: 'Rainy' },
                    { name: 'Helsinki', x: 45, y: 15, country: 'Finland', temp: '5¬∞C', condition: 'Snow' },
                    { name: 'Zurich', x: 30, y: 38, country: 'Switzerland', temp: '14¬∞C', condition: 'Clear' }
                ];
                
                cities.forEach(city => {
                    const marker = document.createElement('div');
                    marker.className = 'city-marker';
                    marker.style.left = city.x + '%';
                    marker.style.top = city.y + '%';
                    marker.dataset.city = city.name;
                    marker.dataset.country = city.country;
                    marker.dataset.temp = city.temp;
                    marker.dataset.condition = city.condition;
                    
                    const label = document.createElement('div');
                    label.className = 'city-label';
                    label.textContent = city.name;
                    label.style.left = city.x + '%';
                    label.style.top = (city.y - 3) + '%';
                    
                    marker.addEventListener('click', () => this.exploreCity(city));
                    
                    citiesContainer.appendChild(marker);
                    citiesContainer.appendChild(label);
                });
            }

            async exploreCity(city) {
                await this.loadWeatherForCity(city.name);
                this.updateAirQuality(city);
                this.focusRadarOnCity(city);

                const existingPopup = document.querySelector('.city-popup');
                if (existingPopup) existingPopup.remove();

                const popup = document.createElement('div');
                popup.className = 'city-popup';
                popup.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: rgba(0, 0, 0, 0.95);
                    border: 2px solid #3498db;
                    border-radius: 15px;
                    padding: 25px;
                    color: white;
                    z-index: 10001;
                    min-width: 300px;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
                `;

                popup.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h3 style="margin: 0; color: #3498db;">${city.name}</h3>
                        <button onclick="this.parentElement.parentElement.remove()" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer;">√ó</button>
                    </div>
                    <div style="margin-bottom: 10px;"><strong>Country:</strong> ${city.country}</div>
                    <div style="margin-bottom: 10px;"><strong>Temperature:</strong> ${city.temp}</div>
                    <div style="margin-bottom: 10px;"><strong>Condition:</strong> ${city.condition}</div>
                    <div style="margin-bottom: 10px;"><strong>Air Quality:</strong> <span id="popup-aqi">Loading...</span></div>
                    <div style="margin-bottom: 15px;"><strong>Local Time:</strong> ${new Date().toLocaleTimeString()}</div>
                    <button onclick="this.parentElement.remove()" style="
                        background: #3498db;
                        border: none;
                        color: white;
                        padding: 8px 16px;
                        border-radius: 6px;
                        cursor: pointer;
                        width: 100%;
                    ">Close</button>
                `;

                document.body.appendChild(popup);
                this.loadCityAirQuality(city.name);
            }

            updateAirQuality(city) {
                const aqiData = this.getAirQualityForCity(city.name);
                
                const aqiValue = document.getElementById('aqi-value');
                const aqiLabel = document.getElementById('aqi-label');
                const aqiDescription = document.querySelector('.aqi-description');
                
                if (aqiValue) aqiValue.textContent = aqiData.value;
                if (aqiLabel) aqiLabel.textContent = aqiData.label;
                if (aqiDescription) aqiDescription.textContent = aqiData.description;
                
                const aqiCard = aqiValue?.closest('.sidebar-card');
                if (aqiCard) {
                    aqiCard.style.borderLeft = `4px solid ${aqiData.color}`;
                }
            }

            getAirQualityForCity(cityName) {
                const airQualityData = {
                    'London': { value: 65, label: 'Moderate', description: 'Air quality is acceptable for most people.', color: '#f39c12' },
                    'Paris': { value: 72, label: 'Moderate', description: 'Sensitive individuals may experience minor issues.', color: '#f39c12' },
                    'Berlin': { value: 45, label: 'Good', description: 'Air quality is good for outdoor activities.', color: '#27ae60' },
                    'Madrid': { value: 58, label: 'Moderate', description: 'Air quality is generally acceptable.', color: '#f39c12' },
                    'Rome': { value: 78, label: 'Moderate', description: 'Consider limiting outdoor activities.', color: '#f39c12' },
                    'Amsterdam': { value: 42, label: 'Good', description: 'Excellent air quality for all activities.', color: '#27ae60' },
                    'Brussels': { value: 55, label: 'Moderate', description: 'Air quality is acceptable for most people.', color: '#f39c12' },
                    'Vienna': { value: 38, label: 'Good', description: 'Perfect air quality for outdoor activities.', color: '#27ae60' },
                    'Prague': { value: 68, label: 'Moderate', description: 'Air quality is acceptable with minor concerns.', color: '#f39c12' },
                    'Warsaw': { value: 85, label: 'Unhealthy', description: 'Everyone may experience health effects.', color: '#e74c3c' },
                    'Stockholm': { value: 28, label: 'Good', description: 'Excellent air quality.', color: '#27ae60' },
                    'Oslo': { value: 25, label: 'Good', description: 'Outstanding air quality.', color: '#27ae60' },
                    'Copenhagen': { value: 35, label: 'Good', description: 'Great air quality for all activities.', color: '#27ae60' },
                    'Helsinki': { value: 22, label: 'Good', description: 'Exceptional air quality.', color: '#27ae60' },
                    'Zurich': { value: 30, label: 'Good', description: 'Excellent air quality.', color: '#27ae60' }
                };
                
                return airQualityData[cityName] || { value: 50, label: 'Moderate', description: 'Air quality data unavailable.', color: '#95a5a6' };
            }

            async loadCityAirQuality(cityName) {
                setTimeout(() => {
                    const aqiData = this.getAirQualityForCity(cityName);
                    const popupAqi = document.getElementById('popup-aqi');
                    if (popupAqi) {
                        popupAqi.innerHTML = `<span style="color: ${aqiData.color};">${aqiData.value} - ${aqiData.label}</span>`;
                    }
                }, 500);
            }

            focusRadarOnCity(city) {
                const mapInfo = document.getElementById('map-info');
                const radarTitle = document.querySelector('.radar-card .forecast-title');
                
                const region = this.getCityRegion(city.name);
                if (radarTitle) {
                    radarTitle.textContent = `${region} Weather Radar`;
                }
                
                if (mapInfo) {
                    mapInfo.innerHTML = `
                        <div><strong>${region} Weather Map</strong></div>
                        <div>Focused on: ${city.name}, ${city.country}</div>
                        <div>Real-time weather data</div>
                        <div>Click other cities to explore</div>
                    `;
                }

                this.updateWeatherLayersForRegion(city, region);
            }

            getCityRegion(cityName) {
                const regionMap = {
                    'London': 'Western Europe',
                    'Paris': 'Western Europe', 
                    'Berlin': 'Central Europe',
                    'Madrid': 'Southern Europe',
                    'Rome': 'Southern Europe',
                    'Amsterdam': 'Western Europe',
                    'Brussels': 'Western Europe',
                    'Vienna': 'Central Europe',
                    'Prague': 'Central Europe',
                    'Warsaw': 'Eastern Europe',
                    'Stockholm': 'Northern Europe',
                    'Oslo': 'Northern Europe',
                    'Copenhagen': 'Northern Europe',
                    'Helsinki': 'Northern Europe',
                    'Zurich': 'Central Europe'
                };
                
                return regionMap[cityName] || 'European';
            }

            updateWeatherLayersForRegion(city, region) {
                const weatherLayers = document.getElementById('weather-layers');
                weatherLayers.innerHTML = '';
                this.createRegionalWeatherLayers(weatherLayers, city, region);
            }

            createRegionalWeatherLayers(container, focusCity, region) {
                const regionConfigs = {
                    'Western Europe': {
                        clouds: [
                            { x: 20, y: 25, size: 120, intensity: 0.8 },
                            { x: 25, y: 35, size: 100, intensity: 0.7 },
                            { x: 30, y: 30, size: 90, intensity: 0.6 }
                        ],
                        storms: [{ x: 24, y: 32, active: true }]
                    },
                    'Central Europe': {
                        clouds: [
                            { x: 32, y: 28, size: 110, intensity: 0.7 },
                            { x: 36, y: 35, size: 95, intensity: 0.6 },
                            { x: 34, y: 40, size: 85, intensity: 0.5 }
                        ],
                        storms: [{ x: 35, y: 32, active: true }]
                    },
                    'Northern Europe': {
                        clouds: [
                            { x: 32, y: 15, size: 130, intensity: 0.9 },
                            { x: 38, y: 18, size: 110, intensity: 0.8 },
                            { x: 42, y: 16, size: 95, intensity: 0.7 }
                        ],
                        storms: [{ x: 36, y: 17, active: true }]
                    },
                    'Southern Europe': {
                        clouds: [
                            { x: 28, y: 50, size: 100, intensity: 0.6 },
                            { x: 32, y: 52, size: 90, intensity: 0.5 },
                            { x: 22, y: 48, size: 85, intensity: 0.4 }
                        ],
                        storms: [{ x: 30, y: 50, active: false }]
                    },
                    'Eastern Europe': {
                        clouds: [
                            { x: 40, y: 30, size: 105, intensity: 0.7 },
                            { x: 44, y: 35, size: 95, intensity: 0.6 },
                            { x: 42, y: 25, size: 88, intensity: 0.5 }
                        ],
                        storms: [{ x: 42, y: 28, active: true }]
                    }
                };

                const config = regionConfigs[region] || regionConfigs['Western Europe'];
                
                config.clouds.forEach(cloud => {
                    const cloudEl = document.createElement('div');
                    cloudEl.className = 'cloud-layer';
                    cloudEl.dataset.layer = 'clouds';
                    cloudEl.style.width = cloud.size + 'px';
                    cloudEl.style.height = cloud.size + 'px';
                    cloudEl.style.left = cloud.x + '%';
                    cloudEl.style.top = cloud.y + '%';
                    cloudEl.style.opacity = cloud.intensity;
                    cloudEl.style.animationDelay = Math.random() * 20 + 's';
                    container.appendChild(cloudEl);
                });

                config.storms.forEach(storm => {
                    if (storm.active) {
                        const stormEl = document.createElement('div');
                        stormEl.className = 'lightning-strike';
                        stormEl.dataset.layer = 'lightning';
                        stormEl.style.left = storm.x + '%';
                        stormEl.style.top = storm.y + '%';
                        stormEl.style.animationDelay = Math.random() * 3 + 's';
                        container.appendChild(stormEl);
                    }
                });

                this.createTemperatureZones(container);
                this.createAirQualityZones(container);
            }

            // Weather layers and geographic features
            createWeatherLayers() {
                const layersContainer = document.getElementById('weather-layers');
                this.createCloudLayers(layersContainer);
                this.createTemperatureZones(layersContainer);
                this.createLightningStrikes(layersContainer);
                this.createAirQualityZones(layersContainer);
                this.setupLayerToggles();
            }

            createCloudLayers(container) {
                const cloudCount = 8;
                const cloudPositions = [
                    { x: 45, y: 35 }, { x: 50, y: 50 }, { x: 60, y: 30 }, { x: 55, y: 60 },
                    { x: 65, y: 45 }, { x: 52, y: 25 }, { x: 58, y: 65 }, { x: 48, y: 40 }
                ];
                
                for (let i = 0; i < cloudCount; i++) {
                    const cloud = document.createElement('div');
                    cloud.className = 'cloud-layer';
                    cloud.dataset.layer = 'clouds';
                    
                    const size = Math.random() * 100 + 60;
                    const pos = cloudPositions[i] || { x: Math.random() * 70 + 15, y: Math.random() * 70 + 15 };
                    
                    cloud.style.width = size + 'px';
                    cloud.style.height = size + 'px';
                    cloud.style.left = pos.x + '%';
                    cloud.style.top = pos.y + '%';
                    cloud.style.animationDelay = Math.random() * 20 + 's';
                    
                    container.appendChild(cloud);
                }
            }

            createTemperatureZones(container) {
                const tempZones = [
                    { x: 45, y: 30, color: 'rgba(100, 150, 255, 0.5)', size: 80 },
                    { x: 55, y: 45, color: 'rgba(100, 200, 100, 0.5)', size: 90 },
                    { x: 50, y: 65, color: 'rgba(255, 200, 100, 0.5)', size: 85 },
                    { x: 65, y: 55, color: 'rgba(255, 150, 50, 0.5)', size: 75 }
                ];
                
                tempZones.forEach(zone => {
                    const tempZone = document.createElement('div');
                    tempZone.className = 'temperature-zone';
                    tempZone.dataset.layer = 'temperature';
                    
                    tempZone.style.width = zone.size + 'px';
                    tempZone.style.height = zone.size + 'px';
                    tempZone.style.left = zone.x + '%';
                    tempZone.style.top = zone.y + '%';
                    tempZone.style.background = zone.color;
                    tempZone.style.animationDelay = Math.random() * 8 + 's';
                    
                    container.appendChild(tempZone);
                });
            }

            createLightningStrikes(container) {
                const lightningPositions = [
                    { x: 48, y: 45 }, { x: 57, y: 55 }, { x: 53, y: 35 }, { x: 62, y: 40 }, { x: 45, y: 50 }
                ];
                
                lightningPositions.forEach(pos => {
                    const lightning = document.createElement('div');
                    lightning.className = 'lightning-strike';
                    lightning.dataset.layer = 'lightning';
                    
                    lightning.style.left = pos.x + '%';
                    lightning.style.top = pos.y + '%';
                    lightning.style.animationDelay = Math.random() * 4 + 's';
                    
                    container.appendChild(lightning);
                });
            }

            createAirQualityZones(container) {
                const aqiZones = [
                    { x: 58, y: 35, intensity: 0.4, size: 70 },
                    { x: 65, y: 45, intensity: 0.6, size: 60 },
                    { x: 62, y: 55, intensity: 0.5, size: 65 }
                ];
                
                aqiZones.forEach(zone => {
                    const aqiZone = document.createElement('div');
                    aqiZone.className = 'air-quality-zone';
                    aqiZone.dataset.layer = 'air-quality';
                    
                    aqiZone.style.width = zone.size + 'px';
                    aqiZone.style.height = zone.size + 'px';
                    aqiZone.style.left = zone.x + '%';
                    aqiZone.style.top = zone.y + '%';
                    aqiZone.style.borderColor = `rgba(255, 100, 100, ${zone.intensity})`;
                    aqiZone.style.animationDelay = Math.random() * 6 + 's';
                    
                    container.appendChild(aqiZone);
                });
            }

            setupLayerToggles() {
                const toggles = document.querySelectorAll('.layer-toggle');
                
                toggles.forEach(toggle => {
                    toggle.addEventListener('click', () => {
                        const layer = toggle.dataset.layer;
                        const isActive = toggle.classList.contains('active');
                        
                        toggle.classList.toggle('active');
                        
                        const layerElements = document.querySelectorAll(`[data-layer="${layer}"]`);
                        layerElements.forEach(element => {
                            element.style.display = isActive ? 'none' : 'block';
                        });
                    });
                });
            }

            createGeographicFeatures() {
                this.createMountains();
                this.createRivers();
            }

            createMountains() {
                const mountainsContainer = document.getElementById('mountains');
                const mountains = [
                    { x: 28, y: 40, size: 'large' }, { x: 30, y: 42, size: 'large' },
                    { x: 32, y: 40, size: 'medium' }, { x: 34, y: 42, size: 'medium' },
                    { x: 22, y: 48, size: 'medium' }, { x: 24, y: 50, size: 'medium' },
                    { x: 26, y: 48, size: 'small' }, { x: 40, y: 38, size: 'medium' },
                    { x: 42, y: 40, size: 'medium' }, { x: 44, y: 38, size: 'small' },
                    { x: 30, y: 12, size: 'large' }, { x: 32, y: 10, size: 'large' },
                    { x: 34, y: 14, size: 'medium' }
                ];

                mountains.forEach(mountain => {
                    const mountainEl = document.createElement('div');
                    mountainEl.className = 'mountain';
                    
                    let borderWidth;
                    switch(mountain.size) {
                        case 'large': borderWidth = '0 0 15px 15px'; break;
                        case 'medium': borderWidth = '0 0 10px 10px'; break;
                        case 'small': borderWidth = '0 0 6px 6px'; break;
                    }
                    
                    mountainEl.style.left = mountain.x + '%';
                    mountainEl.style.top = mountain.y + '%';
                    mountainEl.style.borderWidth = borderWidth;
                    mountainEl.style.borderColor = 'transparent transparent #8d6e63 transparent';
                    mountainEl.style.borderStyle = 'solid';
                    mountainEl.style.width = '0';
                    mountainEl.style.height = '0';
                    mountainEl.style.position = 'absolute';
                    mountainEl.style.opacity = '0.3';
                    
                    mountainsContainer.appendChild(mountainEl);
                });
            }

            createRivers() {
                const riversContainer = document.getElementById('rivers');
                const rivers = [
                    { x: 24, y: 30, width: '80px', height: '2px', rotation: '45deg' },
                    { x: 24, y: 35, width: '100px', height: '2px', rotation: '30deg' },
                    { x: 28, y: 25, width: '120px', height: '2px', rotation: '85deg' },
                    { x: 34, y: 38, width: '150px', height: '2px', rotation: '15deg' },
                    { x: 30, y: 50, width: '80px', height: '2px', rotation: '0deg' },
                    { x: 32, y: 28, width: '90px', height: '2px', rotation: '60deg' }
                ];

                rivers.forEach(river => {
                    const riverEl = document.createElement('div');
                    riverEl.className = 'river';
                    riverEl.style.left = river.x + '%';
                    riverEl.style.top = river.y + '%';
                    riverEl.style.width = river.width;
                    riverEl.style.height = river.height;
                    riverEl.style.transform = `rotate(${river.rotation})`;
                    riverEl.style.position = 'absolute';
                    riverEl.style.background = '#3498db';
                    riverEl.style.borderRadius = '2px';
                    riverEl.style.opacity = '0.6';
                    
                    riversContainer.appendChild(riverEl);
                });
            }

            // Map interactivity
            setupMapInteractivity() {
                const mapContainer = document.getElementById('map-container');
                const worldMap = document.getElementById('world-map');
                const zoomInBtn = document.getElementById('zoom-in');
                const zoomOutBtn = document.getElementById('zoom-out');
                const resetViewBtn = document.getElementById('reset-view');

                const updateZoom = (newZoom) => {
                    this.currentZoom = Math.max(1, Math.min(4, newZoom));
                    worldMap.style.transform = `scale(${this.currentZoom}) translate(${this.mapPosition.x}px, ${this.mapPosition.y}px)`;
                    
                    const mapInfo = document.getElementById('map-info');
                    const scale = Math.round(2500000 / this.currentZoom);
                    mapInfo.innerHTML = `
                        <div><strong>European Weather Map</strong></div>
                        <div>Scale: 1:${scale.toLocaleString()}</div>
                        <div>Zoom: ${Math.round(this.currentZoom * 100)}%</div>
                        <div>Click cities to explore</div>
                    `;
                };

                zoomInBtn.addEventListener('click', () => updateZoom(this.currentZoom + 0.5));
                zoomOutBtn.addEventListener('click', () => updateZoom(this.currentZoom - 0.5));
                resetViewBtn.addEventListener('click', () => {
                    this.currentZoom = 1;
                    this.mapPosition = { x: 0, y: 0 };
                    updateZoom(1);
                });

                mapContainer.addEventListener('mousedown', (e) => {
                    if (this.currentZoom > 1) {
                        this.isDragging = true;
                        this.dragStart.x = e.clientX - this.mapPosition.x;
                        this.dragStart.y = e.clientY - this.mapPosition.y;
                        mapContainer.style.cursor = 'grabbing';
                    }
                });

                mapContainer.addEventListener('mousemove', (e) => {
                    if (this.isDragging && this.currentZoom > 1) {
                        this.mapPosition.x = e.clientX - this.dragStart.x;
                        this.mapPosition.y = e.clientY - this.dragStart.y;
                        
                        const maxPan = 100 * (this.currentZoom - 1);
                        this.mapPosition.x = Math.max(-maxPan, Math.min(maxPan, this.mapPosition.x));
                        this.mapPosition.y = Math.max(-maxPan, Math.min(maxPan, this.mapPosition.y));
                        
                        worldMap.style.transform = `scale(${this.currentZoom}) translate(${this.mapPosition.x}px, ${this.mapPosition.y}px)`;
                    }
                });

                mapContainer.addEventListener('mouseup', () => {
                    this.isDragging = false;
                    mapContainer.style.cursor = 'grab';
                });

                mapContainer.addEventListener('mouseleave', () => {
                    this.isDragging = false;
                    mapContainer.style.cursor = 'grab';
                });

                mapContainer.addEventListener('wheel', (e) => {
                    e.preventDefault();
                    const zoomDelta = e.deltaY > 0 ? -0.2 : 0.2;
                    updateZoom(this.currentZoom + zoomDelta);
                });

                updateZoom(1);
            }

            // Event listeners
            setupEventListeners() {
                const citySearch = document.getElementById('city-search');
                const tempToggle = document.getElementById('temp-toggle');

                citySearch.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && citySearch.value.trim()) {
                        this.loadWeatherForCity(citySearch.value.trim());
                        citySearch.value = '';
                    }
                });

                tempToggle.addEventListener('click', () => {
                    this.isMetric = !this.isMetric;
                    tempToggle.textContent = this.isMetric ? '¬∞C / ¬∞F' : '¬∞F / ¬∞C';
                    
                    if (this.currentWeatherData) {
                        this.updateCurrentWeather(this.currentWeatherData);
                    }
                    if (this.forecastData) {
                        this.updateForecast(this.forecastData);
                        this.updateHourlyForecast(this.forecastData);
                    }
                });
            }

            // UI effects
            createFloatingParticles() {
                setInterval(() => {
                    if (Math.random() < 0.3) {
                        this.createParticle();
                    }
                }, 2000);
            }

            createParticle() {
                const particle = document.createElement('div');
                particle.className = 'floating-particle';
                
                const isSnow = Math.random() < 0.3;
                particle.classList.add(isSnow ? 'particle-snow' : 'particle-rain');
                particle.textContent = isSnow ? '‚ùÑ' : 'üíß';
                
                particle.style.left = Math.random() * 100 + 'vw';
                particle.style.fontSize = (Math.random() * 10 + 10) + 'px';
                particle.style.animationDuration = (Math.random() * 3 + 5) + 's';
                
                document.body.appendChild(particle);
                
                setTimeout(() => {
                    if (particle.parentNode) {
                        particle.parentNode.removeChild(particle);
                    }
                }, 8000);
            }

            addInteractiveEffects() {
                const cards = document.querySelectorAll('.glass-card, .hero-weather-card, .sidebar-card, .forecast-card');
                
                cards.forEach(card => {
                    card.addEventListener('mouseenter', (e) => {
                        e.target.style.transform = 'translateY(-5px) scale(1.02)';
                    });
                    
                    card.addEventListener('mouseleave', (e) => {
                        e.target.style.transform = 'translateY(0) scale(1)';
                    });
                });
            }

            // Loading and error states
            showLoading(message = 'Loading...', subMessage = 'Please wait') {
                const overlay = document.getElementById('loading-overlay');
                const loadingText = document.getElementById('loading-text');
                const loadingSubtext = document.getElementById('loading-subtext');
                
                loadingText.textContent = message;
                loadingSubtext.textContent = subMessage;
                overlay.classList.remove('hidden');
            }

            hideLoading() {
                const overlay = document.getElementById('loading-overlay');
                overlay.classList.add('hidden');
            }

            showError(title, message) {
                this.hideLoading();
                
                const existingError = document.querySelector('.error-container');
                if (existingError) existingError.remove();

                const errorContainer = document.createElement('div');
                errorContainer.className = 'error-container';
                errorContainer.innerHTML = `
                    <div class="error-title">${title}</div>
                    <div class="error-message">${message}</div>
                `;

                document.querySelector('.main-content').prepend(errorContainer);
                
                setTimeout(() => {
                    errorContainer.remove();
                }, 5000);
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            const app = new StormSightApp();
            app.init().catch(error => {
                console.error('Failed to initialize StormSight:', error);
                app.showError('Initialization Error', 'Failed to start the application. Please refresh the page.');
            });
        });
    </script>
</body>
</html>